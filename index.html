<!DOCTYPE html>
<html lang="ja-JP">
    <head>
        <title>speech recognition</title>
    </head>
    <body>
        <div>
            <p id="current"></p>
        </div>
        <div id="result_list">
        </div>
    </body> 
    <script>
        var recognition = new webkitSpeechRecognition();
        recognition.lang = 'ja-JP';
        // recognition.continuous = true;
        recognition.interimResults = true;

        recognition.start();

        recognition.onaudiostart = function () {
            console.log("start")
        }

        recognition.onresult = function(ev) {
            var transcript = ev.results[0][0].transcript;
            document.getElementById("current").textContent = transcript
            if (ev.results[0].isFinal) {
                console.log("final")
                var result_list = document.getElementById("result_list");
                var p = document.createElement("p");
                p.textContent = transcript;
                result_list.insertBefore(p, result_list.firstChild);
            }
        }

        recognition.onend = function() {
            recognition.start();
        }
    </script>
</html>